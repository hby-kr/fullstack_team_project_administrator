<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>위젯 목록</title>
    <style>
        table, th, td { border: 1px solid white; border-collapse: collapse; padding: 8px; }
        th, td { color: white; }
        body { background-color: #121212; color: white; font-family: Arial; }
        .add-widget-bar {
            margin-top: 20px;
            background: green;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            color: white;
            width: 200px;
        }
    </style>
</head>
<body>

<h1>위젯 목록</h1>

<table id="widgetTable">
    <thead>
    <tr>
        <th>ID</th>
        <th>크기</th>
        <th>테마</th>
        <th>JSON</th>
        <th>작업</th>
    </tr>
    </thead>
    <tbody id="widgetBody">
    <!-- 서버 렌더링 데이터도 여기에 포함 가능 -->
    </tbody>
</table>

<div class="add-widget-bar" onclick="addWidget()">+ 위젯 추가</div>

<h2>삭제된 위젯</h2>
<ul id="deletedList"></ul>

<script>
    let nextId = 1000;
    const deletedData = [];

    function addWidget() {
        const table = document.getElementById("widgetBody");
        const row = document.createElement("tr");

        const id = nextId++;
        row.innerHTML = `
            <td>${id}</td>
            <td contenteditable="true">medium</td>
            <td contenteditable="true">dark</td>
            <td contenteditable="true">{"key":"value"}</td>
            <td>
                <button onclick="editWidget(this)">수정</button>
                <button onclick="deleteWidget(this, ${id})">삭제</button>
            </td>
        `;
        table.appendChild(row);
    }

    function editWidget(btn) {
        alert("셀을 직접 수정하세요."); // 또는 실제 수정 로직
    }

    function deleteWidget(btn, id) {
        const row = btn.closest("tr");
        const clone = row.cloneNode(true);  // 복제해서 보관
        clone.querySelector("button[onclick^='deleteWidget']").remove(); // 삭제버튼 제거

        const restoreBtn = document.createElement("button");
        restoreBtn.innerText = "복구";
        restoreBtn.onclick = function () {
            const restored = clone.cloneNode(true);
            const lastTd = restored.querySelector("td:last-child");
            lastTd.innerHTML = `
                <button onclick="editWidget(this)">수정</button>
                <button onclick="deleteWidget(this, ${id})">삭제</button>
            `;
            document.getElementById("widgetBody").appendChild(restored);
            li.remove();
        };

        const li = document.createElement("li");
        li.innerText = `ID ${id} 위젯 `;
        li.appendChild(restoreBtn);
        document.getElementById("deletedList").appendChild(li);

        row.remove();
    }
</script>

</body>
</html>
